var cbuilder={};!function(){var t,n=!1,a="img",e={setObjVariable:function(t,n,a){if(void 0!=n&&"string"==typeof n){n=n.split(",");for(var e=0;e<n.length;e++){var i=n[e];a&&(i=i.replace(a,""));var o="#";n[e].indexOf(".")>=0&&(i=i.replace(/\./gi,""),o=""),t["$"+i]=$(o+n[e])}}},stringToDate:function(t){if(t&&t.indexOf("-")>=4&&t.indexOf(":")>=13){var n=t.split(" ")[0].split("-"),a=t.split(" ")[1].split(":");return new Date(n[0],n[1]-1,n[2],null!==a[0]?a[0]:0,null!==a[1]?a[1]:0,null!==a[2]?a[2]:0)}return/^\d+$/.test(t)?(10===t.length&&(t+="000"),new Date(parseInt(t,10))):void 0},objectCallFunction:function(t){for(var n,a=1;a<arguments.length;a++)n=t[arguments[a]],"function"==typeof n&&n()},ajaxData:function(t,n){var a={type:"post"},e=$.extend({},a,t);$.ajax({url:e.url,data:e.data,type:e.type,success:function(t){"function"==typeof n&&n($.parseJSON(t))}})}},i={_domCache:function(){e.setObjVariable(i,".cb-cropwrap","cb-"),i.$imgpos=i.$cropwrap.find(".imgpos"),t=e.stringToDate($("div[data-nowtime]").data("nowtime"))/1e3||(new Date).getTime()/1e3},tabContainerEvent:function(){$(".tabcontainer").each(function(){var t=$(this),n=$('div[tabcontainer="'+t.attr("id")+'"][tabname]');t.append(n)})},tabEvent:function(){var t=$("div[tabtarget]");t.css("display","block");var n=function(t){var n=t,a=n.attr("tabtarget"),e=$('div[tabname="'+a+'"]'),i=$("#"+e.attr("tabcontainer")),o=i.find('div[tabname="'+a+'"]');0===o.length&&i.append(e),i.find("div").hide(),e.show(),e.find("img,div").show()};t.each(function(){var t=$(this),a=t.attr("tabaction");"click"===a?t.on("click",function(){n($(this))}):"hover"===a&&t.on("mouseover",function(){n($(this))})})},couponEvent:function(){$('.cropwrap .imgpos[linktype="button"]').on("click",function(){var t=$(this).data("id");if(!t)return!1;var n={url:"/index.php?act=coupon&op=receiveCoupon",data:{coupon_ids:t,client:"pc"}};e.ajaxData(n,function(t){var n=t;"60004"===n.code?sbLib.loginShow(0):layer.alert(n.desc)})})},_bindEvents:function(){},_HotLinkComponent:function(){var o=[],d=[],r=[/goods_id=\d+/,/\d+.html/gi,/goods-\d+/],s={checkIconState:function(){i.$imgpos.each(function(t){var n=$(this),a=n.attr("href");if(a&&a.indexOf("item.shenba.com")>=0){for(var e=0;e<r.length;e++)r[e].test(a)&&(a=a.toString(),a=a.match(r[e]));null!=a&&(a=a.toString().match(/\d+/),void 0==n.attr("linkicon")&&null!=a&&o.push(a))}t===i.$imgpos.length-1&&s.showStateIcon()})},checkCountDownState:function(){i.$cropwrap.each(function(){var o=1e3*t,d=$(this),r=e.stringToDate(d.attr("showdate")),s=e.stringToDate(d.attr("hidedate"));void 0===r&&void 0===s?n=!0:(void 0!=r&&void 0===s&&new Date(r)<o&&(n=!0),void 0!=s&&void 0===r&&o<new Date(s)&&(n=!0),void 0!=r&&void 0!=s&&(n=new Date(r)<o&&o<new Date(s))),n?d.find(a).show():(d.hide(),d.find(a).hide()),i.countdownEvent(d)})},showStateIcon:function(){if(0===o.length)return!1;var t={url:"/index.php?act=index&op=getgoods_storage",data:{client:"pc",goods_id:o.toString()}};return e.ajaxData(t,function(t){var n=t;if(void 0!=n.data){var a=n.data;if(1===a.status&&void 0!=a.list){var e=a.list,i=0,o=0;for(i=0,o=e.length;o>i;i++)e[i].goods_storage<=0&&""!==e[i].goods_id&&d.push(e[i].goods_id);for(i=0,o=d.length;o>i;i++)$(".imgpos").each(function(){var t=$(this),n=t.attr("href"),a="";if(n)for(var e=0;e<r.length;e++)a=n.toString().match(/\d+/),a&&a[0]===d[i]&&t.children("b").css("display","block")})}}}),!1},showCountDown:function(n){function a(){var t=1e3*o.data("time"),e=(c.parent().data("cdsuffix"),"");d=o.data("startdate"),r=o.data("enddate"),d>t&&r>t||d>t&&void 0==r?(e="距离开始时间还有: ",i=d-t):(void 0==d&&r>=t||r>=t)&&(e="距离结束时间还有: ",i=r-t);var s,l,h,v,m;if(i>=0){s=Math.floor(i/864e5),i-=864e5*s,l=Math.floor(i/36e5),i-=36e5*l,h=Math.floor(i/6e4),i-=6e4*h,v=Math.floor(i/1e3),10>l&&(l="0"+l),10>h&&(h="0"+h),10>v&&(v="0"+v),m=parseInt(l)+24*s,c.html(s>0&&m>=24?s+"天"+l:m),f.html(e+" "),u.html(h),p.html(v);var g=n.data("time")+1;n.data("time",g),n.cdtimeout=setTimeout(a,1e3)}else"undefined"!=typeof n.cdtimeout&&clearTimeout(n.cdtimeout),o.find(".imgpos[linktype='countdown']").remove()}var i,o=n,d=o.attr("startdate"),r=o.attr("enddate");o.removeAttr("dayhours"),void 0!=d&&(d=new Date(e.stringToDate(d))),void 0!=r&&(r=new Date(e.stringToDate(r))),o.data("startdate",d).data("enddate",r),o.removeAttr("startdate").removeAttr("enddate");var s=o.find(".imgpos[linktype='countdown']");s.each(function(){var t=$(this),n="",a=!1;n+="<span class='edtip'></span>","true"===t.attr("cdsuffix")?(n+="<span class='edh'></span><span>时</span>",n+="<span class='edm'></span><span>分</span>",n+="<span class='eds'></span><span>秒</span>",a=!0):(n+="<span class='edh'></span>",n+="<span class='edm'></span>",n+="<span class='eds'></span>",t.data("cdsuffix","false")),t.removeAttr("cdsuffix"),t.html(n),t.data("cdsuffix",a)}),o.data("time",t);var c=o.find(".edh"),u=o.find(".edm"),f=o.find(".edtip"),p=o.find(".eds");a()},init:function(){e.objectCallFunction(i,"checkIconState","checkCountDownState")}};s.init()},_ComponentsCustomEvent:function(){},_parseComponents:function(){e.objectCallFunction(i,"_domCache","_HotLinkComponent")},init:function(){var t=$("img"),n=t.length,a=0;t.one("load",function(){++a===n&&i._parseComponents()}).each(function(){this.complete&&$(this).load()})}};cbuilder={parse:function(t){t&&(cbuilder.selector=t),$(document).ready(function(){i.init()})}},cbuilder.parse()}();